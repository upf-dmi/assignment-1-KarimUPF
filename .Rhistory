ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
))
wrap_elements(panel = plotA, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
plot_B +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_C
plot_C <- function() {
barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
title(main = "Clinical classification", line = 1)
}
plot_C <- as.ggplot(~plot_C())
library(readxl)
Table_1 <- read_excel("~/Desktop/Master/Term2/DMI/HandsOn/1/Article/Table 1.XLSX", skip = 1, na = "NI")
#summary(Table_1)
# Fixing errors in the data
Table_1 <- Table_1[!duplicated(Table_1$ID), ] # Remove duplicated ID records
Table_1$Gender <- gsub(72, NA, Table_1$Gender)
Table_1$BMI <- gsub(",", ".", Table_1$BMI) # Change comma to decimal
Table_1$BMI <- gsub(0, NA, Table_1$BMI) # Make 0 BMI a NA value
Table_1$BMI <- as.numeric(Table_1$BMI)
Table_1[Table_1$ID == 'COAG-HSJD-180', "Admission to ICU"] <- "Yes" # Incorrect addition of a random number before Yes
Table_1[Table_1$ID == 'COAG-HSJD-076', "Admission to ICU"] <- NA # Incorrect data
Table_1[!Table_1$`ARDS Diagnosis` %in% c("Yes", "No"), "ARDS Diagnosis"] <- NA # Incorrect data
Table_1$`Use of NIV` <- gsub(8, NA, Table_1$`Use of NIV`)
Table_1$Death <- gsub(3, NA, Table_1$Death)
library(patchwork)
library(ggplot2)
# Replicate figure A
plot_A <- as.ggplot(~hist(
Table_1$Age,
ylim = c(0, 50),
main = "Age",
xlab = "Age (years)",
ylab = "Frequency (n)",
col = "lightcyan2" #Plot A
))
# Replicate figure B
library(gridExtra)
library(grid)
library(ggplotify)
grid_table <- data.frame(
Clinical= c('G1', 'G2', 'G3', 'G4'),
NIV = c('-', '-/+', '+', '-/+'),
AMV = c('-', '+/-', '-', '+'),
ARDS = c('-', '-', '+', '+')
)
colnames(grid_table)[1] = 'Clinical\nclassification'
theme <- gridExtra::ttheme_default(
core = list(fg_params=list(cex = 1.0)),
colhead = list(fg_params=list(cex = 0.8)),
rowhead = list(fg_params=list(cex = 0.8)))
grob <- tableGrob(grid_table, theme = theme, rows = NULL)
grob$widths <- unit(rep(0.6 / ncol(grob), ncol(grob)), "npc")
grob$heights <- unit(rep(0.6 / nrow(grob), nrow(grob)), "npc") # new
plot_B <- as.ggplot(grob) + ggtitle("Definition of the clinical classification") + theme(plot.title = element_text(hjust = 0.5, face = "bold"))
# Replicate figure C
assign_group <- function(NIV, AMV, ARDS) {
if (is.na(NIV) || is.na(AMV) || is.na(ARDS)) {
return(NA)
}
if (NIV == "No" && AMV == "No" && ARDS == "No") {
return("G1")
} else if ((NIV %in% c("No", "Yes")) && (AMV %in% c("No", "Yes")) && ARDS == "No") {
return("G2")
} else if (NIV == "Yes" && AMV == "No" && ARDS == "Yes") {
return("G3")
} else if ((NIV %in% c("No", "Yes")) && AMV == "Yes" && ARDS == "Yes") {
return("G4")
} else {
return(NA)
}
}
Table_1$Group <- mapply(assign_group, Table_1$`Use of NIV`, Table_1$`Use of AMV`, Table_1$`ARDS Diagnosis`)
bar_tb <- table(Table_1$Group)
bar_df <- data.frame(
names = names(bar_tb),
numbers = as.numeric(bar_tb)
)
plot_C <- function() {
barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
title(main = "Clinical classification", line = 1)
}
plot_C <- as.ggplot(~plot_C())
bar_tb_d <- table(Table_1$Death)
bar_df_d <- data.frame(
names = names(bar_tb_d),
numbers = as.numeric(bar_tb_d)
)
plot_D <- as.ggplot(~barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
))
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_C <- function() {
barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "Clinical classification",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
#title(main = "Clinical classification", line = 1)
}
plot_C <- as.ggplot(~plot_C())
bar_tb_d <- table(Table_1$Death)
bar_df_d <- data.frame(
names = names(bar_tb_d),
numbers = as.numeric(bar_tb_d)
)
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_B <- as.ggplot(grob) + ggtitle("Definition of the clinical classification") + theme(plot.title = element_text(hjust = 0.5, face = "bold"))
plot_C <- function() {
plot_C <- barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "Clinical classification",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
text(plot_C, bar_df$numbers, cex = 1)
#title(main = "Clinical classification", line = 1)
}
bar_tb_d <- table(Table_1$Death)
bar_df_d <- data.frame(
names = names(bar_tb_d),
numbers = as.numeric(bar_tb_d)
)
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_C <- function() {
plot_C <- barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "Clinical classification",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
text(plot_C, bar_df$numbers, cex = 1)
#title(main = "Clinical classification", line = 1)
plot_C
}
plot_C <- as.ggplot(~plot_C())
bar_tb_d <- table(Table_1$Death)
bar_df_d <- data.frame(
names = names(bar_tb_d),
numbers = as.numeric(bar_tb_d)
)
plot_D <- as.ggplot(~barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
))
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
?text
View(bar_df)
plot_C <- function() {
plot_C <- barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "Clinical classification",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
text(plot_C, bar_df$numbers + 2, labels = bar_df$numbers, cex = 1)
#title(main = "Clinical classification", line = 1)
plot_C
}
bar_tb_d <- table(Table_1$Death)
bar_df_d <- data.frame(
names = names(bar_tb_d),
numbers = as.numeric(bar_tb_d)
)
plot_D <- as.ggplot(~barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
))
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_C <- function() {
plot_C <- barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "Clinical classification",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
text(plot_C, bar_df$numbers + 2, labels = bar_df$numbers, cex = 1)
#title(main = "Clinical classification", line = 1)
}
plot_C <- as.ggplot(~plot_C())
bar_tb_d <- table(Table_1$Death)
bar_df_d <- data.frame(
names = names(bar_tb_d),
numbers = as.numeric(bar_tb_d)
)
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_C <- function() {
plot_C <- barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "Clinical classification",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
text(plot_C, bar_df$numbers + 4, labels = bar_df$numbers, cex = 1)
#title(main = "Clinical classification", line = 1)
}
plot_C <- as.ggplot(~plot_C())
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_D
plot_D <- barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
plot_D
barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
plot_D <- barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status"
)
barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status"
)
plot_C <- function() {
plot_C <- barplot(
names = bar_df$names,
height = bar_df$numbers,
ylim = c(0, 80),
main = "Clinical classification",
xlab = "Clinical classification",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1", "plum2", "indianred1"))
text(plot_C, bar_df$numbers + 4, labels = bar_df$numbers, cex = 1)
#title(main = "Clinical classification", line = 1)
}
plot_C <- as.ggplot(~plot_C())
bar_tb_d <- table(Table_1$Death)
bar_df_d <- data.frame(
names = names(bar_tb_d),
numbers = as.numeric(bar_tb_d)
)
plot_D <- as.ggplot(~barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status"
))
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_D <- function() {
barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
axis(2, at = seq(0, 150, by = 50), labels = seq(0, 150, by = 50))
}
plot_D <- as.ggplot(~plot_D())
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_D <- function() {
par(mgp = c(3, 1, 0))
barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
axis(2, at = seq(0, 150, by = 50), labels = seq(0, 150, by = 50))
}
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_D <- function() {
par(mgp = c(3, 1, 0))
barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
axis(2, at = seq(0, 150, by = 50), labels = seq(0, 150, by = 50))
}
plot_D <- as.ggplot(~plot_D())
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_D <- function() {
par(mgp = c(3, 0, 0))
barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
axis(2, at = seq(0, 150, by = 50), labels = seq(0, 150, by = 50))
}
plot_D <- as.ggplot(~plot_D())
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
?par
plot_D <- function() {
barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
axis(2, at = seq(0, 150, by = 50), labels = seq(0, 150, by = 50))
}
plot_D <- as.ggplot(~plot_D())
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_D <- function() {
plot_D <- barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
text(plot_D, bar_df_d$numbers + 4, labels = bar_df_d$numbers, cex = 1)
axis(2, at = seq(0, 150, by = 50), labels = seq(0, 150, by = 50))
}
plot_D <- as.ggplot(~plot_D())
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
plot_D <- function() {
plot_D <- barplot(
names = bar_df_d$names,
height = bar_df_d$numbers,
ylim = c(0, 150),
xlab = "Death",
ylab = "Frequency (n)",
col = c("aquamarine2", "khaki1"),
main = "Vital status",
yaxt = "n"
)
text(plot_D, bar_df_d$numbers + 6, labels = bar_df_d$numbers, cex = 1)
axis(2, at = seq(0, 150, by = 50), labels = seq(0, 150, by = 50))
}
plot_D <- as.ggplot(~plot_D())
wrap_elements(panel = plot_A, clip = FALSE) +
plot_B +
wrap_elements(panel = plot_C, clip = FALSE) +
wrap_elements(panel = plot_D, clip = FALSE) +
plot_annotation(tag_levels = 'A') # Tag plots
